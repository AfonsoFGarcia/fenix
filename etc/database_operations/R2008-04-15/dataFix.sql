-- Remove 1 broken link from FILE TAGGING RELATION

delete FROM FILE_TAGGING WHERE KEY_UNIT_FILE NOT IN (SELECT ID_INTERNAL FROM FILE);

-- Remove 5 broken links from EXAM_COORDINATOR_MANAGES_VIGILANT_GROUP

delete FROM EXAM_COORDINATOR_MANAGES_VIGILANT_GROUP WHERE KEY_VIGILANT_GROUP NOT IN (SELECT ID_INTERNAL FROM VIGILANT_GROUP);

--- Fix Person broken links.
--- Affected people 127489, 128110, 131307, 133917, 203731, 203757, 217962, 242931 

delete FROM PERSON_NAME_PERSON_NAME_PART WHERE KEY_PERSON_NAME IN (127489, 128110, 131307, 133917, 203731, 203757, 217962, 242931);

insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('127489','19412');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('127489','24831');

insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('128110','109847');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('128110','19832');

insert into PERSON_NAME_PART (KEY_ROOT_DOMAIN_OBJECT, NAME_PART) values ('1','loan');
select @LOAN_ID:=ID_INTERNAL FROM PERSON_NAME_PART WHERE NAME_PART='loan';

insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('131307','5793');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('131307',@LOAN_ID);
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('131307','20835');

insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('133917','110249');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('133917','22644');

insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('203731','1038');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('203731','76045');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('203731','54454');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('203731','3873');

insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('203757','67');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('203757','188');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('203757','67059');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('203757','54480');


insert into PERSON_NAME_PART (KEY_ROOT_DOMAIN_OBJECT, NAME_PART) values ('1','susanne');
select @SUSANNE_ID:=ID_INTERNAL FROM PERSON_NAME_PART WHERE NAME_PART='susanne';

insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('217962',@SUSANNE_ID);
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('217962','9919');
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('217962','61083');


insert into PERSON_NAME_PART (KEY_ROOT_DOMAIN_OBJECT, NAME_PART) values ('1','asa');
select @ASA_ID:=ID_INTERNAL FROM PERSON_NAME_PART WHERE NAME_PART='asa';

insert into PERSON_NAME_PART (KEY_ROOT_DOMAIN_OBJECT, NAME_PART) values ('1','grytli');
select @GRYTLI_ID:=ID_INTERNAL FROM PERSON_NAME_PART WHERE NAME_PART='grytli';

insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('242931',@ASA_ID);
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('242931',@GRYTLI_ID);
insert into PERSON_NAME_PERSON_NAME_PART(KEY_PERSON_NAME, KEY_PERSON_NAME_PART) values('242931','74057');



-- Fix Broken Unit Names
-- IDs Fixed 169147, 169148, 169954, 169949, 169957, 169958, 171961, 174373, 176355, 176590, 184950,235751,238352
-- IDs removed 70124, 169948, 169951

delete FROM UNIT_NAME_UNIT_NAME_PART WHERE KEY_UNIT_NAME IN (70124, 169948, 169951, 169147, 169148, 169949, 169954, 169957, 169958, 171961, 174373, 176355, 176590, 184950,235751,238352);


insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169147','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169147','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169147','41226');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169147','6');


insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169148','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169148','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169148','7619');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169148','41816');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169148','101');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169148','41227');


insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169954','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169954','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169954','42036');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169954','42037');


insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169957','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169957','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169957','7645');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169957','42040');


insert into UNIT_NAME_PART (KEY_ROOT_DOMAIN_OBJECT, NAME_PART) values ('1','seomara');
select @SEOMARA_ID:=ID_INTERNAL FROM UNIT_NAME_PART WHERE NAME_PART='seomara';


insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169958','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169958','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169958',@SEOMARA_ID);
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169958','47');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169958','42654');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169958','42041');



insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('171961','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('171961','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('171961','16');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('171961','42667');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('171961','43435');


insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('174373','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('174373','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('174373','45817');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('174373','16');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('174373','45448');


insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('176355','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('176355','16');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('176355','47629');

insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('176590','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('176590','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('176590','16');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('176590','49222');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('176590','6');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('176590','47855');


insert into UNIT_NAME_PART (KEY_ROOT_DOMAIN_OBJECT, NAME_PART) values ('1','rocha');
select @ROCHA_ID:=ID_INTERNAL FROM UNIT_NAME_PART WHERE NAME_PART='rocha';

insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('184950','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('184950','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('184950',@ROCHA_ID);
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('184950','54225');



insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('235751','13');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('235751','14');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('235751','1924');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('235751','88025');

insert into UNIT_NAME_PART (KEY_ROOT_DOMAIN_OBJECT, NAME_PART) values ('1','biotecnica');
select @BIO_ID:=ID_INTERNAL FROM UNIT_NAME_PART WHERE NAME_PART='biotecnica';


insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('238352','34');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('238352',@BIO_ID);
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('238352','90027');


insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169949','71');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169949','41815');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169949','42027');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169949','24426');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169949','42028');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169949','42029');
insert into UNIT_NAME_UNIT_NAME_PART(KEY_UNIT_NAME, KEY_UNIT_NAME_PART) values('169949','24216');
