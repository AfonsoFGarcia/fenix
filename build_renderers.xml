<?xml version="1.0" encoding="ISO-8859-1"?>
<project basedir="." default="doc" name="Compilation Scripts">

	<property environment="env"/>
	<property name="encoding" value="ISO-8859-1"/>

	<property file="build.properties"/>

	<!-- Source code directories -->
	<property name="src" location="src"/>

	<!-- Directories for compiled code -->
	<property name="build.home" location="build"/>
	<property name="build.home.webinf" location="${build.home}/WEB-INF"/>
	<property name="build.home.webinf.classes" location="${build.home.webinf}/classes"/>

	<property name="config.web" location="metadata"/>
	<property name="config.layouts" location="${config.web}/fenix-renderers-config.xml"/>
	<property name="config.layouts.dtd" location="${config.web}/fenix-renderers-config.dtd"/>

	<property name="tools.build" location="${build.home.webinf.classes}"/>
	<property name="tools.src" location="src_tools"/>
	<property name="tools.lib" location="lib"/>

	<property name="docs.renderers" location="docs/renderers"/>

	<!-- Directories with libraries (JARs) -->
	<property name="lib" location="lib" />

	<path id="tools.compile.classpath">
		<fileset dir="${tools.lib}">
			<include name="**/*.jar"/>
		</fileset>
	</path>
	
	<path id="tools.run.classpath">
		<fileset dir="${tools.lib}">
			<include name="**/*.jar"/>
		</fileset>
	</path>

	<target name="prepare">
		<mkdir dir="${tools.build}"/>
		<mkdir dir="${docs.renderers}"/>
	</target>
	
	<target name="clean">
		<delete dir="${tools.build}"/>
	</target>
	
	<target name="compile-doclet" depends="prepare">
		<javac destdir="${tools.build}" debug="true">
			<src path="${tools.src}"/>
			<include name="pt/utl/ist/renderers/**"/>
			<classpath refid="tools.compile.classpath"/>
		</javac>
		<copy todir="${tools.build}">
			<fileset dir="${tools.src}" >
				<include name="pt/utl/ist/renderers/**"/>
				<exclude name="pt/utl/ist/renderers/**/*.java"/>
			</fileset>
		</copy>
	</target>
	
	<target name="doc" depends="compile-doclet">
		<javadoc access="private">
			<classpath refid="tools.run.classpath"/>
			
			<packageset dir="${src}">
				<include name="net/sourceforge/fenixedu/renderers/**"/>
			    <include name="net/sourceforge/fenixedu/presentationTier/renderers/**"/>
			</packageset>
			
			<doclet name="pt.utl.ist.renderers.RenderersConfigDoclet" path="${tools.build}">
				<path refid="tools.run.classpath"/>
				
				<param name="-d" value="${docs.renderers}"/>
				<param name="-c" value="${config.layouts}"/>
				<param name="-dtd" value="${config.layouts.dtd}"/>
				<param name="-type" value="html"/>
			</doclet>
		</javadoc>
	</target>
	
</project>
