<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts-config PUBLIC 
      "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
      "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">
<struts-config>
    
    <!-- ========== Data Source Configuration =============================== -->

    
    <!-- ========== Form Bean Definitions ================================== -->
    <form-beans type="org.apache.struts.action.ActionFormBean">

      <form-bean name="personForm"
      			type="org.apache.struts.validator.DynaValidatorForm"
      			dynamic="true">
		<form-property name="username" type="java.lang.String"/>
		<form-property name="documentIdNumber" type="java.lang.String"/>
		<form-property name="page" type="java.lang.Integer"/>
      </form-bean>
      
      <form-bean name="submitPhotoForm"
				type="org.apache.struts.validator.DynaValidatorForm"
      			dynamic="true">
		<form-property name="username" type="java.lang.String"/>
		<form-property name="theFile" type="java.lang.String"/>
		<form-property name="page" type="java.lang.Integer"/>
	  </form-bean>

	  <form-bean name="generateNewPasswordsForm"
				type="org.apache.struts.validator.DynaValidatorForm"
      			dynamic="true">
			<form-property name="fromNumber" type="java.lang.String"/>
			<form-property name="toNumber" type="java.lang.String"/>
			<form-property name="page" type="java.lang.Integer"/>
	  </form-bean>
	  
	  <form-bean name="generatePasswordsForCandidaciesForm"
			type="org.apache.struts.validator.DynaValidatorForm"
     			dynamic="true">
		<form-property name="executionDegreeId" type="java.lang.Integer"/>
		<form-property name="candidacyIdsToProcess" type="java.lang.Integer[]" />
		<form-property name="page" type="java.lang.Integer"/>
		<form-property name="entryPhase" type="java.lang.String" />
  	  </form-bean>
  	  
  	  <form-bean name="curricularCourseEquivalenciesForm" type="org.apache.struts.validator.DynaValidatorForm" dynamic="true">
			<form-property name="page" type="java.lang.Integer" initial="0"/>
			<form-property name="degreeID" type="java.lang.String"/>
			<form-property name="degreeCurricularPlanID" type="java.lang.String"/>
			<form-property name="curricularCourseID" type="java.lang.String"/>
			<form-property name="oldDegreeID" type="java.lang.String"/>
			<form-property name="oldDegreeCurricularPlanID" type="java.lang.String"/>
			<form-property name="oldCurricularCourseID" type="java.lang.String"/>
			<form-property name="curricularCourseEquivalencyID" type="java.lang.String"/>
		</form-bean>
		
		<form-bean name="findPersonForm"
		    	type="org.apache.struts.validator.DynaValidatorForm"
		    	dynamic="true">
		    		<form-property name="name" type="java.lang.String"/>	
		    		<form-property name="email" type="java.lang.String"/>
		    		<form-property name="username" type="java.lang.String"/>
		    		<form-property name="documentIdNumber" type="java.lang.String"/>
		    		<form-property name="mechanoGraphicalNumber" type="java.lang.String"/>
		    		<form-property name="page" type="java.lang.Integer" initial="0"/>     		    		
		    </form-bean>
		    
		<form-bean name="rolesForm"
                type="org.apache.struts.validator.DynaValidatorForm"
                dynamic="true">
	        <form-property name="roleOIDs" type="java.lang.String[]"/>
	        <form-property name="username" type="java.lang.String"/>
	        <form-property name="documentIdNumber" type="java.lang.String"/>
	        <form-property name="page" type="java.lang.Integer"/>
     	</form-bean>
     	
     	<form-bean name="equivalencesForm" type="org.apache.struts.validator.DynaValidatorForm" dynamic="true">
			<form-property name="method" type="java.lang.String"/>
			<form-property name="studentNumber" type="java.lang.String"/>
			<form-property name="curricularCoursesID" type="java.lang.Integer[]"/>
			<form-property name="studentCurricularPlanID" type="java.lang.String"/>
		</form-bean>

     </form-beans>
    
    <!-- ========== Global Exception Definitions ============================== -->
	<global-exceptions>
        <exception
			type="java.lang.Exception"
			key="error.Exception"
            handler="net.sourceforge.fenixedu.presentationTier.config.FenixContainerExceptionHandler"
			/>
		<exception
			type="net.sourceforge.fenixedu.applicationTier.Servico.exceptions.NotAuthorizedException"
			key="error.NotAuthorized"
			handler="net.sourceforge.fenixedu.presentationTier.config.FenixContainerExceptionHandler"
			/>
        <exception
            type="net.sourceforge.fenixedu.injectionCode.IllegalDataAccessException"
            key="error.NotAuthorized"
            handler="net.sourceforge.fenixedu.presentationTier.config.FenixContainerExceptionHandler"
            />
	</global-exceptions>
    
    <!-- ========== Global Forward Definitions =============================== -->
    <global-forwards type="org.apache.struts.action.ActionForward">
      <forward name="home" path="/mainPortalPage.jsp" redirect="true" contextRelative="true"/>
      <forward name="logoff" path="/logoff.do" contextRelative="true"/>
      <forward name="redirect" path="/redirect.do" contextRelative="true"/>
      <forward name="globalOutOfPeriod" path="definition.out.of.period"/>              
    </global-forwards>
    
    <!-- ========== Action Mapping Definitions =============================== -->
    <action-mappings type="org.apache.struts.action.ActionMapping">
      <!-- page fronting actions -->
      <action path="/index" forward="/index.jsp"/>
			<action	name="personForm"
					attribute="personForm"
					type="net.sourceforge.fenixedu.presentationTier.Action.operator.FindPersonAction"
					path="/findPerson"
					input="/findPerson.do?method=prepareFindPerson&amp;page=0"
					parameter="method"
					scope="request"
					validate="true">
				<exception	type="net.sourceforge.fenixedu.presentationTier.Action.exceptions.NonExistingActionException"
							key="resources.Action.exceptions.NonExistingActionException"
							handler="net.sourceforge.fenixedu.presentationTier.config.FenixErrorExceptionHandler"/>
				<forward name="choosePerson" path="/password/choosePersonPage.jsp"/>
				<forward name="confirmPasswordChange" path="/password/confirmPasswordChange.jsp"/>
			</action>
	      
			<action	type="net.sourceforge.fenixedu.presentationTier.Action.commons.password.GenerateNewPasswordDispatchAction"
					path="/generateNewPassword"
					input="/generateNewPassword.do?method=prepare&amp;page=0"
					parameter="method"
					scope="request"
					validate="true">
				<exception	type="net.sourceforge.fenixedu.presentationTier.Action.exceptions.NonExistingActionException"
							key="resources.Action.exceptions.NonExistingActionException"
							handler="net.sourceforge.fenixedu.presentationTier.config.FenixErrorExceptionHandler"/>
				<forward name="Success" path="/password/newPasswordTemplate.jsp"/>
			</action>

			<action path="/submitPhoto"
					parameter="method"
					validate="true"
					input="/submitPhoto.do?method=preparePhotoUpload&amp;page=0"
					name="submitPhotoForm"
					type="net.sourceforge.fenixedu.presentationTier.Action.operator.SubmitPhotoAction"
					scope="request">
				<forward name="chooseFile" path="/photo/submitPhoto.jsp"/>
			</action>

        	<action path="/pendingPhotos" parameter="method" validate="true"
        		type="net.sourceforge.fenixedu.presentationTier.Action.operator.PendingPhotosAction" scope="request">
        		<forward name="list" path="operator.photos.pending" />
	       </action>
		    
		   <action 	path="/generatePasswordsForCandidacies"
					input="/generatePasswordForCandidacies.do?method=chooseExecutionDegree&amp;page=0"
					parameter="method"
					name="generatePasswordsForCandidaciesForm"
					type="net.sourceforge.fenixedu.presentationTier.Action.operator.GeneratePasswordsForCandidaciesAction"
					scope="request">
				<forward name="chooseExecutionDegree" path="df.candidacy.password.chooseExecutionDegreeAndEntryPhase"/>
				<forward name="prepare" path="df.candidacy.password.generate"/>
				<forward name="success" path="/candidacy/password/severalNewPasswordsTemplate.jsp"/>
		   </action>
		   
		   <action path="/back" forward="home" />
		   
		   <!-- ========== Generate User Universal Identifier =============== -->
		   <action 	path="/generateUserUID"
					parameter="method"					
					type="net.sourceforge.fenixedu.presentationTier.Action.operator.GenerateUserUID"
					scope="request">				
				<forward name="prepareSearchPerson" path="prepare.search.person.to.generate.userUID"/>	
		   </action>
		   
		   <!-- ========== Alumni Identity Check Requests =============== -->
		   <action 	path="/alumni"
					parameter="method"					
					type="net.sourceforge.fenixedu.presentationTier.Action.operator.AlumniOperations"
					scope="request">
				<forward name="alumni.view.identity.requests.list" path="alumni.view.identity.requests.list"/>
				<forward name="alumni.validate.request" path="alumni.validate.request"/>
				<forward name="alumni.validate.request.result" path="alumni.validate.request.result"/>
				<forward name="alumni.closed.identity.requests" path="alumni.closed.identity.requests"/>
		   </action>
		   
		   <!-- ========== SYSTEM MONITORING MANIPULATION ========== -->
		   <action path="/monitorSystem"
	              type="net.sourceforge.fenixedu.presentationTier.Action.manager.MonitorSystemDA"
	              parameter="method"
	              >
	          <forward name="Show" path="df.page.monitor-system"/>
	      </action>
	      
	      <!-- =================== Logins Management =================== -->
        <action path="/loginsManagement"
				type="net.sourceforge.fenixedu.presentationTier.Action.manager.LoginsManagementDA"
       			scope="request"       			
				input="/index.do"
       			parameter="method">       			       			
       			<forward name="prepareSearchPerson" path="prepare-search-person-to-logins-management"/>
       			<forward name="prepareManageLoginAlias" path="prepare-manage-login-alias"/> 
       			<forward name="prepareManageLoginTimeIntervals" path="prepare-manage-login-time-intervals"/>       			
       			<forward name="prepareCreateNewLoginAlias" path="prepare-create-new-login-alias"/>       			       			
       			<forward name="prepareEditLoginAlias" path="prepare-edit-login-alias"/>     
       			<forward name="prepareEditLoginTimeInterval" path="prepare-edit-login-time-interval"/>   
       			<forward name="prepareCreateNewLoginTimeInterval" path="prepare-create-new-login-time-interval"/>          			         			  			       			       			
       	</action>
       	
       	<!-- =================== Equivalences =================== -->
       	<action path="/showNotNeedToEnroll"
		       	name="equivalencesForm"
	       		type="net.sourceforge.fenixedu.presentationTier.Action.manager.equivalences.ManageNotNeedToEnrollDispathAction"
	       		scope="request"
				input=""
	       		parameter="method">
       		<forward name="showNotNeedToEnroll" path="show-not-need-to-enroll"/>
       		<forward name="insertNotNeedToEnroll" path="/showNotNeedToEnroll.do?method=prepareNotNeedToEnroll"/>
       	</action>
       	
       	<action path="/prepareNotNeedToEnroll" forward="show-not-need-to-enroll"/>
       	
       	<!-- ==================== Curricular Course Equivalencies ================== -->
       	<action path="/curricularCourseEquivalencies"
       			type="net.sourceforge.fenixedu.presentationTier.Action.manager.CurricularCourseEquivalenciesDA"
				input="/curricularCourseEquivalencies.do?method=prepare&amp;page=0"
				name="curricularCourseEquivalenciesForm"
    	   		scope="request"
       			parameter="method">
			<exception type="net.sourceforge.fenixedu.domain.exceptions.DomainException"
				key="error.exists.curricular.course.equivalency"
				handler="net.sourceforge.fenixedu.presentationTier.config.FenixErrorExceptionHandler"/>
       		<forward name="showEquivalencies" path="show-curricular-course-equivalencies"/>
       		<forward name="showCreateEquivalencyForm" path="show-create-curricular-course-equivalencies"/>
       	</action>
       	
       	<!-- ========== ROLE MANIPULATION ========== -->
       	<action path="/viewPersonsWithRole"
      			input="/viewPersonsWithRole.do?method=prepare"
				type="net.sourceforge.fenixedu.presentationTier.Action.manager.ViewPersonsWithRoleDA"
				parameter="method"
				validate="false"
				scope="request"
				>
          <forward name="SelectRole" path="df.page.manage-persons-with-role"/>
          <forward name="ShowPersons" path="df.page.manage-persons-with-role"/>
          <forward name="ShowRoleOperationLogs" path="df.page.show-roleoperationlogs"/>
      	</action>
      	
      	<!-- ========== EXECUTION DEGREE MANAGEMENT ========== -->
      	<action path="/manageHolidays"
				input="/manageHolidays.do?method=prepare&amp;page=0"
				parameter="method"
				scope="request"
				type="net.sourceforge.fenixedu.presentationTier.Action.manager.ManageHolidaysDA">
			<forward name="showHolidays" path="df.show.holidays" />
		</action>
		
		<!-- ========== PERSON MANAGEMENT ========== -->
		<action path="/personManagement"
				type="net.sourceforge.fenixedu.presentationTier.Action.manager.personManagement.PersonManagementAction"
				parameter="method"
				scope="request"
				input="findPerson">
			<forward name="firstPage" path="df.personManagement.firstPage"/>
		</action>
		
		<action path="/findPerson"
				type="net.sourceforge.fenixedu.presentationTier.Action.manager.personManagement.PersonManagementAction"
				parameter="method"
				scope="request"
				name="findPersonForm"
				input="findPerson">
			<forward name="findPerson" path="findPerson"/>
			<forward name="displayPerson" path="displayPerson"/>
			<forward name="viewPerson" path="viewPerson" />
		</action>
		
		<action path="/recoverInactivePerson"
				input="/recoverInactivePerson.do?method=prepare&amp;page=0"
				parameter="method"
				scope="request"
				type="net.sourceforge.fenixedu.presentationTier.Action.manager.RecoverInactivePersonDA">
			<forward name="showSearchForm" path="df.recover.inactive.person.search.form" />
		</action>
		
		<action path="/editPerson"
				type="net.sourceforge.fenixedu.presentationTier.Action.manager.personManagement.PersonManagementAction"
				parameter="method"
				scope="request"
				input="personManagement">
			<forward name="searchPersonToEdit" path="search-person-to-edit"/>
			<forward name="prepareEditPerson" path="prepare-edit-person"/>
		</action>	
		
		<action path="/manageRoles"
      		  name="rolesForm"
		      input="/manageRoles.do?method=prepare&amp;page=0"
              type="net.sourceforge.fenixedu.presentationTier.Action.manager.ManageRolesDA"
              parameter="method"
              validate="false"
              scope="request">
          <forward name="SelectUserPage" path="df.page.manage-roles"/>
          <forward name="Manage" path="df.page.manage-roles"/>
          <forward name="ShowRoleOperationLogs" path="df.page.show-roleoperationlogs"/>
     	</action>
      
		<action path="/generateNewPassword"
		  		type="net.sourceforge.fenixedu.presentationTier.Action.base.FenixForwardAction" 
				forward="show-generate-password-link"/>
				
		<action path="/createInvitedPerson"
			type="net.sourceforge.fenixedu.presentationTier.Action.manager.personManagement.PersonManagementAction"
			parameter="method"
			scope="request"
			input="personManagement">
			<forward name="showExistentPersonsBeforeCreateInvitedPerson" path="show-existent-persons-before-create-invited-person"/>
			<forward name="prepareCreateInvitedPerson" path="prepare-create-invited-person"/>				
		</action>
		
		<action path="/invitationsManagement"
			type="net.sourceforge.fenixedu.presentationTier.Action.manager.personManagement.PersonManagementAction"
			parameter="method"
			scope="request"
			input="personManagement">
			<forward name="searhPersonBeforeInvitationsManagement" path="searh-person-before-invitations-management"/>		
			<forward name="managePersonInvitations" path="manage-person-invitations"/>	
			<forward name="prepareEditInvitation" path="prepare-edit-invitation"/>		
			<forward name="prepareEditInvitationDetails" path="prepare-change-invitation-details"/>										
			<forward name="prepareCreateNewPersonInvitation" path="prepare-create-new-person-invitation"/>										
		</action>
		   
     </action-mappings>     

    
    <!-- ========== Controller Configuration ================================ -->
	 <controller processorClass="net.sourceforge.fenixedu.presentationTier.processor.FenixRequestProcessorWithTiles"/>
	     
    <!-- ========== Message Resources Definitions ============================ -->
	<message-resources parameter="resources.ManagerResources" key="MANAGER_RESOURCES" null="false"/>
	<message-resources parameter="resources.ApplicationResources" key="APPLICATION_RESOURCES" null="false"/>
    <message-resources parameter="resources.GlobalResources" key="GLOBAL_RESOURCES" null="false"/>

    <!-- ========== Plug Ins Configuration ================================= -->
    <plug-in className="org.apache.struts.validator.ValidatorPlugIn">
      <set-property property="pathnames" 
                    value="/WEB-INF/validator-rules.xml,/WEB-INF/fenix-validator-rules.xml,/WEB-INF/conf/validation-operator.xml"/>
    </plug-in>
    <plug-in className="org.apache.struts.tiles.TilesPlugin" >
	  <set-property property="definitions-config"
					  value="/WEB-INF/tiles/layouts/tiles-layout-definitions.xml,/WEB-INF/tiles/operator/tiles-operator-definitions.xml,/WEB-INF/tiles/operator/tiles-operator-pages-definitions.xml" />                    
	  <set-property property="moduleAware" value="true" />
	  <set-property property="definitions-parser-validate" value="true" />					  
    </plug-in>
</struts-config> 